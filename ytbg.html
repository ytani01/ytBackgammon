<!DOCTYPE HTML>
<html lang="jp">
  <head>
    <meta charset="utf-8">
    <!-- <meta http-equiv="X-UA-Compatible" content="IE=edge"> -->
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="viewport"
          content="width=device-width, initial-scale=0.4, minimum-scale=0.05, maximum-scale=3">
    <title>ytBackgammon: network shared backgammon board (alpha)</title>

    <script>
      const set_main = id => {
          console.log(`set_main>id=${id}`);
          const url = document.getElementById(id).src + "?sound=off";
          console.log(`set_main>url=${url}`);

          document.cookie = `main_viewer=${encodeURIComponent(id)};`;
          document.getElementById("main_board_id").innerHTML = id;
          document.getElementById("main_viewer").src = url;
      };

      window.onload = () => {
          let id = undefined;
          for (let ent of document.cookie.split("; ")) {
              console.log(`window.onload>ent=${ent}`);
              const [key, val] = ent.split("=");
              if ( key == "main_viewer" ) {
                  id = val;
                  break;
              }
          }
          console.log(`window.onload>id=${id}`);
          if ( id === undefined ) {
              return;
          }
          set_main(decodeURIComponent(id));
      };
    </script>
    <script src='https://meet.jit.si/external_api.js'></script>
  </head>
  <body style="background-image:url(./bg.png);width:900px;">
    <h1 style="color:#222;">【ytBackgammon】</h1>
    <h2 style="color:#222;">ネットワーク共有型バックギャモンボード<br />
      (network shared backgammon board)</h2>
    <hr />
    <h3>ビデオチャット(Jitsi = ジッツィ)との統合を実験中！</h3>
    <p>
      (アプリ不要、アカウント不要、完全無料、人数無制限)
    </p>
    <ul>
      <li> スマホでは
        「…モバイルアプリが必要です。」
        と表示されますが、
        <strong>[Webで起動する]</strong>を選択して下さい。
      </li>
      <li> スマホを縦にすると、相手側で画像が乱れることがあります。
        <strong>なるべく横向きで</strong>ご利用下さい。
      </li>
      <li> 重く<strong>不安定になったら</strong>、
        <strong>カメラを切って</strong>下さい。
      </li>
      <li> 何か不具合が起きたら、気軽に
        <strong>[退出] --&gt; [再入室]</strong>
        してみて下さい。
      </li>
      <li> <strong>再入室</strong>する場合は、
        ブラウザでこのページを<strong>リロード(再読込)</strong>して下さい。
      </li>
    </ul>
    <br />
    <hr />
    <h1 style="color:#222;">[Main viewer] <span id="main_board_id"></span></h1>
    <h3 style="color:#222;">下段のボードから、ここに表示するボードを選んで下さい。</h3>
    
    <!--    <div style="float:left;"> -->
    <div>
      <div style="width:880px;height:560px">
        <iframe id="main_viewer"
                name="main"
                src=""
                width="1030px" height="650px"
                style="transform:scale(0.835);transform-origin:left top;">
        </iframe>
      </div>
    </div>
    [チャット画面] …別のタブで開く場合は
    <a href="https://meet.jit.si/ytani01" target="_blank">【こちら】</a>
    <div id="meet">
    </div>
    <div style="float:left;">
      <a href="https://ytbg1.ytani.net/?board=1&sound=off"
         target="main" style="color:#222;"
         onClick="set_main('Board_1');">[ Board_1 ]</a>

      <div style="width:450px;height:270px">
        <iframe id="Board_1"
                src="https://ytbg1.ytani.net/"
                width="1030px" height="650px"
                style="transform:scale(0.4);transform-origin:left top;">
        </iframe>
      </div>
    </div>

    <div style="float:left;">
      <a href="https://ytbg2.ytani.net/?board=2&sound=off"
         target="main" style="color:#222;"
         onClick="set_main('Board_2');">[ Board_2 ]</a>

      <div style="width:450px;height:270px">
        <iframe id="Board_2"
                src="https://ytbg2.ytani.net/"
                width="1030px" height="650px"
                style="transform:scale(0.4);transform-origin:left top;">
        </iframe>
      </div>
    </div>

    <div style="float:left;">
      <a href="https://ytbg3.ytani.net/?board=3&sound=off"
         target="main" style="color:#222;"
         onClick="set_main('Board_3');">[ Board_3 ]</a>

      <div style="width:450px;height:270px">
        <iframe id="Board_3"
                src="https://ytbg3.ytani.net/"
                width="1030px" height="650px"
                style="transform:scale(0.4);transform-origin:left top;">
        </iframe>
      </div>
    </div>

    <div style="float:left;">
      <a href="https://ytbg4.ytani.net/?board=4&sound=off"
         target="main" style="color:#222;"
         onClick="set_main('Board_4')">[ Board_4 ]</a>

      <div style="width:450px;height:270px">
        <iframe id="Board_4"
                src="https://ytbg4.ytani.net/"
                width="1030px" height="650px"
                style="transform:scale(0.4);transform-origin:left top;">
        </iframe>
      </div>
    </div>

    <script>
      const domain = 'meet.jit.si'; // Jitsi用に使用しているドメイン名
      const options = {
          roomName: 'ytani01', // チャットルーム名
          width: 860, // ビデオチャット表示部分の幅
          height: 550, // ビデオチャット表示部分の高さ
          parentNode: document.querySelector('#meet') // ビデオチャットを表示する要素のID
      };
      const api = new JitsiMeetExternalAPI(domain, options);
    </script>
  </body>
</html>
